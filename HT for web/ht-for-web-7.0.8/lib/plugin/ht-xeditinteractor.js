!function(p,V,x){"use strict";var J="ht",r=p[J],E=r.Default,G=r.graph,t=E.getInternal(),$=t.ui(),X=$.NodeUI.prototype,B=$.ShapeUI.prototype,e=G.GraphView,W=e.prototype,I=$.EdgeUI.prototype,D=r.Node,A=r.Shape,c=r.Edge,O=r.Group,k=E.isTouchable,u=E.preventDefault,h=p.setTimeout,q=E.grow,Z=E.isDragging,y=E.getDistance,H=null,a=r.List,v="undefined"!=typeof Float32Array?Float32Array:Array,o=Math,l=o.PI,S="Crossing",m="No Crossing",g=l/2,N=2*l,K=o.atan2,T=o.sqrt,f=o.pow,Y=o.sin,L=o.cos,z=o.min,U=o.max,F=o.abs,R=o.ceil,w=o.round,b=E.unionPoint,C=E.unionRect,j=E.containsPoint,d=E.clone,M="rgb(52, 152, 219)",_="red",i={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},s={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var v=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],F=0;F<v.length;F++){var l=v[F];l=0===F%2?l/400*s.width:l/100*s.height,v[F]=l}return s.width>120&&(v[4]=s.width-26,v[6]=s.width-40,v[10]=s.width-40,v[12]=s.width-26,v[18]=33),v}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},P={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:M,rotation:.61},{type:"circle",rect:[200,120,70,70],background:M,rotation:.61},{type:"circle",rect:[200,220,70,70],background:M,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:M},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:M}]},Q={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:_,rotation:.61}]},n={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:M},{type:"circle",rect:[0,210,90,90],background:M},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:M}]},Ur={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:_},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:_}]},bq={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:M}]},Bf={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:_}]},Sl={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},gj={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},po=function(H){var n=H.touches[0];return n?n:H.changedTouches[0]},Zn=function(Y,A,t,L){return K(L-A,t-Y)},Hp=function(f,F){return{x:f.x*F,y:f.y*F}},Wp=function(Q,m){Q.each(function(A){return Q.isSelected(A)?m(A):void 0})},Ij=function(N,d){N.reverseEach(function(x){return N.isSelected(x)?d(x):void 0})},yp=function(t,f,M){var G,p,e,K,g,X=this,L=f,B=X.gv;if(t instanceof A){e=t.getSegments();var T=B.getDataUI(t);g=T._55O.$15l,e&&e.size()||(e=Xp(g)),t.isClosePath()&&e.indexOf(5)<0&&(e=new a(e._as),e.add(5)),G=ce(t,T,L),p=g[G]}else{var h=B.getDataUI(t);g=Aq(h,t.s("edge.points")),e=t.s("edge.segments"),e&&e.size()||(e=Xp(g)),g=g._as,G=ce(t,h,L),p=g[G]}if(e&&(K=e.get(L)),2===K||1===K||5===K){var b=g[G+1];5===K&&(b=g[0]);var V=Ug(p,M,b);return V}return M},tn=function(Y,Z,U,u){var C=Z/2,W=U/2,D=Yo(Y,-C,-W,u),T=Yo(Y,C,-W,u),L=Yo(Y,-C,W,u),X=Yo(Y,C,W,u),j=Yo(Y,0,-W,u),o=Yo(Y,C,0,u),e=Yo(Y,0,W,u),h=Yo(Y,-C,0,u);return[D,T,L,X,j,o,e,h]},Ug=function(U,R,o){var H={x:R.x-U.x,y:R.y-U.y},Z={x:o.x-U.x,y:o.y-U.y},X=T(f(o.x-U.x,2)+f(o.y-U.y,2)),D={x:Z.x/X,y:Z.y/X},x=H.x*D.x+H.y*D.y,i={x:D.x*x,y:D.y*x};return{x:U.x+i.x,y:U.y+i.y}},Yo=function(z,I,Q,C){var A=L(C)*I-Y(C)*Q,u=Y(C)*I+L(C)*Q;return z?{x:z.x+A,y:z.y+u}:{x:A,y:u}},Fp=function(H,a){return a>2*H?H:a/2},Mq=function(s,E,A,Q){var P=y(s,E);return A=Q?z(A,P):Fp(A,P),P?A/=P:A=0,{x:s.x+(E.x-s.x)*A,y:s.y+(E.y-s.y)*A}},ah=function(e,c){var m,G,j=e.gv,N=e._data,Z=N._40I,v=N._41I,V=N.s("edge.offset"),T=N.s("edge.source.position"),R=N.s("edge.target.position"),P=N.s("edge.source.offset.x"),X=N.s("edge.source.offset.y"),A=N.s("edge.target.offset.x"),B=N.s("edge.target.offset.y"),J=N.s("edge.source.anchor.x"),Q=N.s("edge.source.anchor.y"),n=N.s("edge.target.anchor.x"),r=N.s("edge.target.anchor.y");if(c?(m=t.getEdgeAgentPosition(j,Z,T,P,X,J,Q),G=t.getEdgeAgentPosition(j,v,R,A,B,n,r)):(m=t.getEdgeAgentPosition(j,Z,T,0,0,J,Q),G=t.getEdgeAgentPosition(j,v,R,0,0,n,r)),"points"===N.s("edge.type")&&V&&!N.s("edge.center")&&m){var d=N.s("edge.points")||new a,K=d.size(),w=Mq(m,K?d.get(0):G,V,K),W=Mq(G,K?d.get(K-1):m,V,K);m=w,G=W}return[m,G]},Aq=function(f,D,n){var T=f._78o,M=f._data,i=M.s("edge.type"),U=[T.sourcePoint,T.targetPoint];return"points"===i?n&&(U=ah(f)):U=T.center?i?n?ah(f):ah(f,!0):n?ah(f):[T.c1,T.c2]:n?ah(f):ah(f,!0),D=new a(D?D._as:H),D.add(U[0],0),D.add(U[1]),D},Cc=function(w){return w=new a(w._as),w.removeAt(0),w.removeAt(w.size()-1),w},Xp=function(b){b._as||(b=new a(b));var Z=new a;Z.add(1);for(var E=1;E<b.size();E++)Z.add(2);return Z},Vd=function(h,u){return{x:(h.x+u.x)/2,y:(h.y+u.y)/2}},mr=function(Y,w){return{x:Y.x+1*(w.x-Y.x)/4,y:Y.y+1*(w.y-Y.y)/4}},ul=function(D,r){return{x:D.x+3*(r.x-D.x)/4,y:D.y+3*(r.y-D.y)/4}},oe=function(i,r,U,G){var Z=r.x+r.width/2,w=r.y+r.height/2,$=T(Z*Z+w*w),z=K(w,Z)+U;return{x:G.x+$*L(z),y:G.y+$*Y(z)}},ws=W.validateImpl,Fg=W.isRectEditable,Up=W.isPointEditable,Ng=W._42,ir=B._79o,ro=I._79o,Rd=B._48O,_p=B._47O,xo=X._48O,kl=X._80o,gc=B._80o,Lq=X.getSelectWidth,Fr=X._47O,tl=I._47O,Sr=W.isEditable,hs=["northwest","north","northeast","east","southeast","south","southwest","west"],Fd=function(k,i,P,D,C,c,Z,V,Y,n){var t=k.x,K=k.y,A=k.width,E=k.height,m={x:t+A/2,y:K+E/2};D=D||0,i=Yo(m,i.x-m.x,i.y-m.y,-D),Z&&!V&&(i.x+=Y,i.y+=n);var p=.01;if("northwest"===P?(i.x+C>t+A-p&&(i.x=t+A-C-p),i.y+C>K+E-p&&(i.y=K+E-C-p),k=b(i,{x:t+A,y:K+E})):"north"===P?(i.y+C>K+E-p&&(i.y=K+E-C-p),k=b({x:t,y:i.y},{x:t+A,y:K+E})):"northeast"===P?(i.x<t+C+p&&(i.x=t+C+p),i.y+C>K+E-p&&(i.y=K+E-C-p),k=b({x:t,y:i.y},{x:i.x,y:K+E})):"west"===P?(i.x+C>t+A-p&&(i.x=t+A-C-p),k=b({x:i.x,y:K},{x:t+A,y:K+E})):"east"===P?(i.x<t+C+p&&(i.x=t+C+p),k=b({x:t,y:K},{x:i.x,y:K+E})):"southwest"===P?(i.x+C>t+A-p&&(i.x=t+A-C-p),i.y<K+C+p&&(i.y=K+C+p),k=b({x:i.x,y:K},{x:t+A,y:i.y})):"south"===P?(i.y<K+C+p&&(i.y=K+C+p),k=b({x:t,y:K},{x:t+A,y:i.y})):"southeast"===P&&(i.x<t+C+p&&(i.x=t+C+p),i.y<K+C+p&&(i.y=K+C+p),k=b({x:t,y:K},i)),"keepRatio"===c&&(!Z&&V||Z&&!V)&&("northeast"===P||"southeast"===P||"northwest"===P||"southwest"===P)){var s=k.width,F=k.height,J=s/A,M=F/E,u=z(J,M);k.width=A*u,k.height=E*u,"northeast"===P?k.y=K+(E-k.height):"northwest"===P?(k.y=K+(E-k.height),k.x=t+(A-k.width)):"southwest"===P&&(k.x=t+(A-k.width))}k.x-=m.x,k.y-=m.y;var Q=oe(H,k,D,m);return k.x=Q.x-k.width/2,k.y=Q.y-k.height/2,k},$k=function(v,u,q,n){var V=v.getRotation(),Y=u,c=Y.x,S=Y.y,U=Y.width,C=Y.height,I={x:c+Y.width/2,y:S+Y.height/2};n=Yo(I,n.x-I.x,n.y-I.y,-V),"northwest"===q?Y=b(n,{x:c+U,y:S+C}):"north"===q?Y=b({x:c,y:n.y},{x:c+U,y:S+C}):"northeast"===q?Y=b({x:c,y:n.y},{x:n.x,y:S+C}):"west"===q?Y=b({x:n.x,y:S},{x:c+U,y:S+C}):"east"===q?Y=b({x:c,y:S},{x:n.x,y:S+C}):"southwest"===q?Y=b({x:n.x,y:S},{x:c+U,y:n.y}):"south"===q?Y=b({x:c,y:S},{x:c+U,y:n.y}):"southeast"===q&&(Y=b({x:c,y:S},n)),v.setRect(Y),Y.x-=I.x,Y.y-=I.y;var x=oe(v,Y,V,I);v.p(x.x,x.y)},er=function(M,i,C,N,r,O,f,d){var m=H;O?(m=Yo(H,r.x-i.x,r.y-i.y,-C),m.x-=f.x,m.y-=f.y):m=Yo(H,r.x-i.x,r.y-i.y,0);var V={x:i.x+m.x,y:i.y+m.y};d&&(V=d(V.x,V.y)),V.e=M.getPoints().get(N).e,M.setPoint(N,V);var q=M.getWidth(),x=M.getHeight(),L=M.p().x-q/2,U=M.p().y-x/2;L-=i.x,U-=i.y;var X=oe(M,{x:L,y:U,width:q,height:x},C,i);M.p(X.x,X.y)},ce=function(j,D,$){var N,_;if(j instanceof A?(N=j.getPoints(),_=j.getSegments()):j instanceof c&&"points"===j.s("edge.type")&&(N=j.s("edge.points"),_=j.s("edge.segments"),N=Aq(D,N)),_&&_.size()||(_=Xp(N)),j instanceof A&&j.isClosePath()&&_.indexOf(5)<0&&(_=new a(_._as),_.add(5)),_)for(var X=-1,m=0;m<_.size();m++){if(m===$)return X;var J=_.get(m);1===J?X+=1:2===J?X+=1:3===J?X+=2:4===J&&(X+=3)}},vg=function(S,L,V){var o,J;if(S instanceof A?(o=S.getPoints(),J=S.getSegments()):S instanceof c&&"points"===S.s("edge.type")&&(o=S.s("edge.points"),J=S.s("edge.segments"),o=Aq(L,o)),J&&J.size()||(J=Xp(o)),J)for(var j=-1,N=0;N<J.size();N++){var b=J.get(N);if(1===b?j+=1:2===b?j+=1:3===b?j+=2:4===b&&(j+=3),j===V)return N}},sb=function(A,I){var F=[A[0]-I[0],A[1]-I[1],A[2]-I[2]];return F},xp=function(){var B=new v(16);return B[0]=1,B[1]=0,B[2]=0,B[3]=0,B[4]=0,B[5]=1,B[6]=0,B[7]=0,B[8]=0,B[9]=0,B[10]=1,B[11]=0,B[12]=0,B[13]=0,B[14]=0,B[15]=1,B},ub=function(M,X){var y=M[0],N=M[1],B=M[2];return M[0]=X[0]*y+X[4]*N+X[8]*B+X[12],M[1]=X[1]*y+X[5]*N+X[9]*B+X[13],M[2]=X[2]*y+X[6]*N+X[10]*B+X[14],M},mf=function(t,I){if(I){var f=Y(I),K=L(I),C=t[0],P=t[1],O=t[2],l=t[3],V=t[8],c=t[9],$=t[10],v=t[11];t[0]=C*K-V*f,t[1]=P*K-c*f,t[2]=O*K-$*f,t[3]=l*K-v*f,t[8]=C*f+V*K,t[9]=P*f+c*K,t[10]=O*f+$*K,t[11]=l*f+v*K}},jd=function(F,R){for(var U=F.s("grid.row.count"),i=F.s("grid.column.count"),P=0;U>P;P++)for(var e=0;i>e;e++){var I=F.getCellRect(P,e);if(j(I,R))return{rowIndex:P,columnIndex:e,rect:I,grid:F}}return null},pj=function(z,E,w,B,b,i){var k={},q=w-z,t=B-E,Z=o.sqrt(q*q+t*t),x=q/Z,A=t/Z,W=(-z+b)*x+(-E+i)*A;return 0>=W?(k.x=z,k.y=E):W>=Z?(k.x=w,k.y=B):(k.x=z+W*x,k.y=E+W*A),q=b-k.x,t=i-k.y,k.z=o.sqrt(q*q+t*t),k},on=function(x,c){var I,m,u,e,S,P,U,j,W=x.getPoints(),L=x.getSegments(),D=x.p(),B=x.getRotation();if(!L||!(L.indexOf(3)>0||L.indexOf(4)>0)){for(j=0;j<=W.size()-1;j++)if(j===W.size()-1?(S=W.get(0),e=W.get(j)):(e=W.get(j),S=W.get(j+1)),e=Yo(D,e.x-D.x,e.y-D.y,B),S=Yo(D,S.x-D.x,S.y-D.y,B),P=pj(e.x,e.y,S.x,S.y,c.x,c.y),U=P.z,U<(x.s("shape.border.width")||10)){m=e,u=S,I=j;break}if(I!=H){var Z=pj(m.x,m.y,u.x,u.y,c.x,c.y),l=y(m,Z);return{attachIndex:I,attachOffset:l}}}},hg=function(A){for(var i=A._data,G=i.p(),p=i.getRotation(),l=i.getPoints(),d=H,V=[],C=0;C<l.size();C++)d=l.get(C),V.push(Yo(G,d.x-G.x,d.y-G.y,p));A._55O.$15l=V};E.setImage("xeditinteractor_parentIcon",P),E.setImage("xeditinteractor_hostIcon",Q),E.setImage("xeditinteractor_edgeIcon",n),E.setImage("xeditinteractor_removeIcon",Ur),E.setImage("xeditinteractor_sourceIcon",bq),E.setImage("xeditinteractor_targetIcon",Bf),E.setImage("xeditinteractor_elevationIcon",Sl),E.setImage("xeditinteractor_tallIcon",gj),W._editPointSize=k?24:9,W._edgeHelpers=["parent","remove","source","target"],W._leftTopHelpers=["parent"],W._rightTopHelpers=["host"],W._leftBottomHelpers=["edge"],W._rightBottomHelpers=["remove"],hs=hs.concat(hs).concat(hs),I._79o=function(){var j=this,B=j.gv,O=B.getZoom(),k=B._editInteractor,S=ro.call(j);if(!S)return null;var l=ah(j,!0),J=l[0],f=l[1],g={x:S.x,y:S.y,width:S.width,height:S.height},s=b(J,f);if(k instanceof G.XEditInteractor){g=C(g,s);var T=j._55O,u=B.getEditPointSize()/O+2,V=0;T&&T._43O&&(V+=u/2,q(g,V))}return g},I._47O=function(i){var W=this,Z=W.gv,l=Z._editInteractor;l instanceof G.XEditInteractor||tl.call(W,i)},I.rectIntersects=function(K){var U=this,q=U._data,c=U.gv,t=c.getZoom(),R=U._55O,J=c._editInteractor;if(J instanceof G.XEditInteractor&&c.isEditable(q)&&R&&R._43O&&"points"===q.s("edge.type")){var Y=q.s("edge.points"),v=q.s("edge.segments");Y=Aq(U,Y),v&&v.size()||(v=Xp(Y)),Y=Y._as;var l=!1,X=k?5:1,P=K.x+X,I=K.y+X,E={x:P,y:I};if(J._edge===q&&J._hoverSegmentIndex>=0){var z=c._editInteractor._hoverSegmentIndex,Q=v.get(z),N=ce(q,U,z),F=H;if(N!=H&&N>=0){var W=Y[N],d=c.getSegmentHoverWidth()/t;if(2===Q||1===Q){var e=Y[N+1];F=ab(new aj(W.x,W.y),new aj(e.x,e.y),new aj(E.x-d,E.y-d),new aj(E.x+2*d,E.y+2*d)),F.$62l===S&&(l=!0)}else if(3===Q){var A=Y[N+1],e=Y[N+2];F=On(new aj(W.x,W.y),new aj(A.x,A.y),new aj(e.x,e.y),new aj(E.x-d,E.y-d),new aj(E.x+2*d,E.y+2*d)),F.$62l===S&&(l=!0)}else if(4===Q){var r=Y[N+1],$=Y[N+2];e=Y[N+3],F=Cq(new aj(W.x,W.y),new aj(r.x,r.y),new aj($.x,$.y),new aj(e.x,e.y),new aj(E.x-d,E.y-d),new aj(E.x+2*d,E.y+2*d)),F.$62l===S&&(l=!0)}}}if(l)return!0}return H},B._47O=function(C){var Q=this,v=Q.gv,K=v._editInteractor;K instanceof G.XEditInteractor||_p.call(Q,C)},B.rectIntersects=function(I){var q=this,F=q._data,Y=q.gv,B=Y.getZoom(),j=q._55O,h=Y._editInteractor;if(h instanceof G.XEditInteractor&&Y.isEditable(F)&&j&&j._43O){var D=j.$15l,n=!1,e=k?5:1,u=I.x+e,g=I.y+e,o={x:u,y:g};if(D&&D.length===F.getPoints().size()||(hg(q),D=j.$15l),h._shape===F&&h._hoverSegmentIndex>=0){var i=F.getSegments();i&&i.size()||(i=Xp(D));var M=Y._editInteractor._hoverSegmentIndex,A=i.get(M),y=ce(F,q,M),U=H;if(y!=H&&y>=0){var Q=D[y],p=Y.getSegmentHoverWidth()/B;if(2===A||1===A){var Z=D[y+1];U=ab(new aj(Q.x,Q.y),new aj(Z.x,Z.y),new aj(o.x-p,o.y-p),new aj(o.x+2*p,o.y+2*p)),U.$62l===S&&(n=!0)}else if(3===A){var v=D[y+1],Z=D[y+2];U=On(new aj(Q.x,Q.y),new aj(v.x,v.y),new aj(Z.x,Z.y),new aj(o.x-p,o.y-p),new aj(o.x+2*p,o.y+2*p)),U.$62l===S&&(n=!0)}else if(4===A){var K=D[y+1],z=D[y+2];Z=D[y+3],U=Cq(new aj(Q.x,Q.y),new aj(K.x,K.y),new aj(z.x,z.y),new aj(Z.x,Z.y),new aj(o.x-p,o.y-p),new aj(o.x+2*p,o.y+2*p)),U.$62l===S&&(n=!0)}}}if(n)return!0}return H},B._48O=function(){var b=this,v=b.gv,I=v._editInteractor;I instanceof G.XEditInteractor?(X._48O.call(b),b._55O._43O&&hg(b)):Rd.call(b)},B._79o=function(){var t=this,M=t.gv,i=M.getZoom(),x=M._editInteractor,c=ir.call(t);if(c){var D={x:c.x,y:c.y,width:c.width,height:c.height};if(x instanceof G.XEditInteractor){var o=t._55O,e=M.getEditPointSize()/i+2,R=0;o&&o._43O&&(R+=e/2,q(D,R))}return D}},X._47O=function(W){var y=this,g=y.gv,j=g._editInteractor;if(j instanceof G.XEditInteractor);else{var f=y._55O;f&&f._98o&&Fr.call(y,W)}},X.getSelectWidth=function(){var N=this,_=N.gv,S=_._editInteractor,E=N._data;return _.isEditable(E)&&S instanceof G.XEditInteractor?0:Lq.call(N)},X._80o=function(Q){var U=this,i=U.gv._editInteractor;if(kl.call(U,Q),i&&i._debug){Q.save(),Q.beginPath(),Q.lineWidth=1,Q.strokeStyle="green";var u=U._79o();u&&(Q.rect(u.x,u.y,u.width,u.height),Q.stroke()),Q.restore()}},B._80o=function(k){var F=this,T=F.gv._editInteractor;if(gc.call(F,k),T&&T._debug){k.save(),k.beginPath(),k.lineWidth=1,k.strokeStyle="green";var w=F._79o();k.rect(w.x,w.y,w.width,w.height),k.stroke(),k.restore()}},X._48O=function(){var j=this,S=j.gv,H=j._data,x=S._editInteractor,E=j._55O,K=H.p(),i=H.getRotation();if(x instanceof G.XEditInteractor){if(E._42O){var g=tn(K,H.getWidth(),H.getHeight(),i),T=g[0],V=g[1],o=g[2],P=g[3],p=g[4],y=g[5],M=g[6],h=g[7];E.$45l=[T,p,V,y,P,M,o,h]}}else xo.call(j)},W.getResizeMode=function(){return this.$25l||"normal"},W.setResizeMode=function(J){var V=this.$25l;this.$25l=J,this.fp("resizeMode",V,J)},W.getSnapAngle=function(){return this.$26l||Math.PI/36},W.setSnapAngle=function(e){var x=this.$26l;this.$26l=e,this.fp("snapAngle",x,e)},W.getSnapSpacing=function(){return this.$27l},W.setSnapSpacing=function(X){var L=this.$27l;this.$27l=X,this.fp("snapSpacing",L,X)},W.getPointSnapSpacing=function(){return this._pointSnapSpacing},W.setPointSnapSpacing=function(J){var N=this._pointSnapSpacing;this._pointSnapSpacing=J,this.fp("pointSnapSpacing",N,J)},W.setHelperEditableFunc=function(k){var x=this._helperEditableFunc;this._helperEditableFunc=k,this.fp("helperEditableFunc",x,k)},W.getHelperEditableFunc=function(){return this._helperEditableFunc},W.setLeftTopHelpers=function(y){var t=this._leftTopHelpers;this._leftTopHelpers=y,this.fp("leftTopHelpers",t,y)},W.getLeftTopHelpers=function(){return this._leftTopHelpers},W.setLeftTopHelpersAlign=function(N){var z=this._leftTopHelpersAlign;this._leftTopHelpersAlign=N,this.fp("leftTopHelpersAlign",z,N)},W.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},W.setRightTopHelpers=function(u){var x=this._rightTopHelpers;this._rightTopHelpers=u,this.fp("rightTopHelpers",x,u)},W.getRightTopHelpers=function(){return this._rightTopHelpers},W.setRightTopHelpersAlign=function(j){var V=this._rightTopHelpersAlign;this._rightTopHelpersAlign=j,this.fp("rightTopHelpersAlign",V,j)},W.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},W.setLeftBottomHelpers=function(A){var u=this._leftBottomHelpers;this._leftBottomHelpers=A,this.fp("leftBottomHelpers",u,A)},W.getLeftBottomHelpers=function(){return this._leftBottomHelpers},W.setLeftBottomHelpersAlign=function(c){var f=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=c,this.fp("leftBottomHelpersAlign",f,c)},W.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},W.setRightBottomHelpers=function(o){var U=this._rightBottomHelpers;this._rightBottomHelpers=o,this.fp("rightBottomHelpers",U,o)},W.getRightBottomHelpers=function(){return this._rightBottomHelpers},W.setRightBottomHelpersAlign=function(s){var z=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=s,this.fp("rightBottomHelpersAlign",z,s)},W.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},W.setEdgeHelpers=function(m){var D=this._edgeHelpers;this._edgeHelpers=m,this.fp("edgeHelpers",D,m)},W.getEdgeHelpers=function(){return this._edgeHelpers},W.isHelperEditable=function(d,w){return d instanceof c&&("host"===w||"edge"===w||"elevation"===w||"tall"===w)?!1:d instanceof D&&("source"===w||"target"===w)?!1:"pointElevation"===w?this._helperEditableFunc?this._helperEditableFunc(d,w):!1:this._helperEditableFunc?this._helperEditableFunc(d,w):!0},W.getEditHelperSize=function(){return this._editHelperSize||(k?28:16)},W.setEditHelperSize=function(M){var Y=this._editHelperSize;this._editHelperSize=M,this.fp("editHelperSize",Y,M)},W.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},W.setEditRectBorderColor=function(l){var F=this.$28l;this.$28l=l,this.fp("editRectBorderColor",F,l)},W.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},W.setNodeBorderColor=function(w){var d=this.$29l;this.$29l=w,this.fp("nodeBorderColor",d,w)},W.getEditRectBorderStyle=function(){return this.$30l||"dashed"},W.setEditRectBorderStyle=function(M){var X=this.$30l;this.$30l=M,this.fp("editRectBorderStyle",X,M)},W.getControlPointBackground=function(){return this.$31l||"#ff0"},W.setControlPointBackground=function(M){var x=this.$31l;this.$31l=M,this.fp("controlPointBackground",x,M)},W.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},W.setControlPointBorderColor=function(J){var S=this.$32l;this.$32l=J,this.fp("controlPointBorderColor",S,J)},W.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},W.setJoinPointBackground=function(v){var h=this.$33l;this.$33l=v,this.fp("joinPointBackground",h,v)},W.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},W.setJoinPointBorderColor=function(t){var c=this.$34l;this.$34l=t,this.fp("joinPointBorderColor",c,t)},W.getDirectionLineColor=function(){return this.$35l||"#888"},W.setDirectionLineColor=function(H){var U=this.$35l;this.$35l=H,this.fp("directionLineColor",U,H)},W.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},W.setSegmentHoverColor=function(u){var o=this.$36l;this.$36l=u,this.fp("segmentHoverColor",o,u)},W.getSegmentHoverWidth=function(){return this.$22l||(k?16:8)},W.setSegmentHoverWidth=function(u){var j=this.$22l;this.$22l=u,this.fp("segmentHoverWidth",j,u)},W.getSnapPointBorderColor=function(){return this.$38l||"#f00"},W.setSnapPointBorderColor=function(n){var f=this.$38l;this.$38l=n,this.fp("snapPointBorderColor",f,n)},W.getEditRectPadding=function(){return this.$39l!=H?this.$39l:6},W.setEditRectPadding=function(W){var T=this.$39l;this.$39l=W,this.fp("editRectPading",T,W)},W.isRectEditable=function(J){var $=this,U=$._editInteractor;return U instanceof G.XEditInteractor?$._rectEditableFunc?$._rectEditableFunc(J):!0:Fg.call($,J)},W.isPointEditable=function($){var i=this,h=i._editInteractor;return h instanceof G.XEditInteractor?i._pointEditableFunc?i._pointEditableFunc($):!0:Up.call(i,$)},W.validateImpl=function(){var T=this,C=T.$14l,o=T._editInteractor;if(C){var S=T.getWidth(),P=T.getHeight();(S!==C.clientWidth||P!==C.clientHeight)&&(o&&(o._68I=1),t.setCanvas(C,S,P),T._32I=1)}ws.call(this)},W.isEditable=function(y){var s=Sr.call(this,y),N=this._editInteractor;if(N instanceof G.XEditInteractor&&y instanceof c){if(!y.s("2d.editable"))return!1;var u=this.getEditableFunc();s=u?u(y):!0}return s},W._42=function(d,B){var I=this,q=I._editInteractor;Ng.call(I,d,B),q instanceof G.XEditInteractor&&q._68I&&q._42()},W.isSnapPoint=function(){return!0};var Jr=function(K){arguments.length>0&&this.$58l(K)},Ob=Jr.prototype;Ob.$58l=function(w){this.$62l=w,this.points=new Array},Ob.$56l=function(V){this.points.push(V)},Ob.$57l=function(l){this.points=this.points.concat(l)};var aj=function(D,V){arguments.length>0&&this.$58l(D,V)},Ri=aj.prototype;Ri.$58l=function(G,E){this.x=G,this.y=E},Ri.add=function(Y){return new aj(this.x+Y.x,this.y+Y.y)},Ri.addEquals=function(D){return this.x+=D.x,this.y+=D.y,this},Ri.$55l=function(i){return new aj(this.x*i,this.y*i)},Ri.eq=function($){return this.x==$.x&&this.y==$.y},Ri.lt=function(h){return this.x<h.x&&this.y<h.y},Ri.lte=function(d){return this.x<=d.x&&this.y<=d.y},Ri.gt=function(C){return this.x>C.x&&this.y>C.y},Ri.gte=function(t){return this.x>=t.x&&this.y>=t.y},Ri.lerp=function(h,Q){return new aj(this.x+(h.x-this.x)*Q,this.y+(h.y-this.y)*Q)},Ri.distanceFrom=function(g){var l=this.x-g.x,b=this.y-g.y;return T(l*l+b*b)},Ri.min=function(c){return new aj(z(this.x,c.x),z(this.y,c.y))},Ri.max=function(p){return new aj(U(this.x,p.x),U(this.y,p.y))},Ri.toString=function(){return this.x+","+this.y};var Kn=function(){this.$58l(arguments)},oq=Kn.prototype;Kn.TO=1e-6,Kn.AC=6,oq.$58l=function(p){this.co=new Array;for(var u=p.length-1;u>=0;u--)this.co.push(p[u])},oq.$55l=function(d){for(var G=new Kn,f=0;f<=this.$50l()+d.$50l();f++)G.co.push(0);for(var f=0;f<=this.$50l();f++)for(var g=0;g<=d.$50l();g++)G.co[f+g]+=this.co[f]*d.co[g];return G},oq.$59l=function(){for(var e=this.$50l();e>=0&&F(this.co[e])<=Kn.TO;e--)this.co.pop()},oq.$50l=function(){return this.co.length-1},oq.$51l=function(){var k;switch(this.$59l(),this.$50l()){case 0:k=new Array;break;case 1:k=this.$52l();break;case 2:k=this.$53l();break;case 3:k=this.$54l();break;case 4:k=this.$63l();break;default:k=new Array}return k},oq.$52l=function(){var A=new Array,u=this.co[1];return 0!=u&&A.push(-this.co[0]/u),A},oq.$53l=function(){var $=new Array;if(2==this.$50l()){var V=this.co[2],Z=this.co[1]/V,P=this.co[0]/V,w=Z*Z-4*P;if(w>0){var N=T(w);$.push(.5*(-Z+N)),$.push(.5*(-Z-N))}else 0==w&&$.push(.5*-Z)}return $},oq.$63l=function(){var W=new Array;if(4==this.$50l()){var p=this.co[4],n=this.co[3]/p,t=this.co[2]/p,v=this.co[1]/p,B=this.co[0]/p,N=new Kn(1,-t,n*v-4*B,-n*n*B+4*t*B-v*v).$54l(),g=N[0],U=n*n/4-t+g;if(F(U)<=Kn.TO&&(U=0),U>0){var f=T(U),d=3*n*n/4-f*f-2*t,I=(4*n*t-8*v-n*n*n)/(4*f),G=d+I,Z=d-I;if(F(G)<=Kn.TO&&(G=0),F(Z)<=Kn.TO&&(Z=0),G>=0){var w=T(G);W.push(-n/4+(f+w)/2),W.push(-n/4+(f-w)/2)}if(Z>=0){var w=T(Z);W.push(-n/4+(w-f)/2),W.push(-n/4-(w+f)/2)}}else if(0>U);else{var I=g*g-4*B;if(I>=-Kn.TO){if(0>I&&(I=0),I=2*T(I),d=3*n*n/4-2*t,d+I>=Kn.TO){var R=T(d+I);W.push(-n/4+R/2),W.push(-n/4-R/2)}if(d-I>=Kn.TO){var R=T(d-I);W.push(-n/4+R/2),W.push(-n/4-R/2)}}}}return W},oq.$54l=function(){var v=new Array;if(3==this.$50l()){var m=this.co[3],c=this.co[2]/m,a=this.co[1]/m,j=this.co[0]/m,P=(3*a-c*c)/3,G=(2*c*c*c-9*a*c+27*j)/27,Q=c/3,S=G*G/4+P*P*P/27,u=G/2;if(F(S)<=Kn.TO&&(S=0),S>0){var w,g,k=T(S);w=-u+k,g=w>=0?f(w,1/3):-f(-w,1/3),w=-u-k,w>=0?g+=f(w,1/3):g-=f(-w,1/3),v.push(g-Q)}else if(0>S){var i=T(-P/3),M=K(T(-S),-u)/3,q=L(M),B=Y(M),E=T(3);v.push(2*i*q-Q),v.push(-i*(q+E*B)-Q),v.push(-i*(q-E*B)-Q)}else{var w;w=u>=0?-f(u,1/3):f(-u,1/3),v.push(2*w-Q),v.push(-w-Q)}}return v};var zo=function(d,f){arguments.length>0&&this.$58l(d,f)},_q=zo.prototype;_q.$58l=function(c,A){this.x=c,this.y=A},_q.length=function(){return T(this.x*this.x+this.y*this.y)},_q.$60l=function(u){return this.x*u.x+this.y*u.y};var zf=function(u,d,y,N){var h,K=(N.x-y.x)*(u.y-y.y)-(N.y-y.y)*(u.x-y.x),i=(d.x-u.x)*(u.y-y.y)-(d.y-u.y)*(u.x-y.x),f=(N.y-y.y)*(d.x-u.x)-(N.x-y.x)*(d.y-u.y);if(0!=f){var U=K/f,W=i/f;U>=0&&1>=U&&W>=0&&1>=W?(h=new Jr(S),h.points.push(new aj(u.x+U*(d.x-u.x),u.y+U*(d.y-u.y)))):h=new Jr(m)}else h=0==K||0==i?new Jr("C"):new Jr("P");return h},os=function(Y,N,o,s,d){var W,K,l,X,$,x,b,D=s.min(d),a=s.max(d),Z=new Jr(m);W=N.$55l(-2),l=Y.add(W.add(o)),W=Y.$55l(-2),K=N.$55l(2),X=W.add(K),$=new aj(Y.x,Y.y),b=new zo(s.y-d.y,d.x-s.x),x=s.x*d.y-d.x*s.y;for(var I=new Kn(b.$60l(l),b.$60l(X),b.$60l($)+x).$51l(),i=0;i<I.length;i++){var p=I[i];if(p>=0&&1>=p){var V=Y.lerp(N,p),Q=N.lerp(o,p),E=V.lerp(Q,p);s.x==d.x?D.y<=E.y&&E.y<=a.y&&(Z.$62l=S,Z.$56l(E)):s.y==d.y?D.x<=E.x&&E.x<=a.x&&(Z.$62l=S,Z.$56l(E)):E.gte(D)&&E.lte(a)&&(Z.$62l=S,Z.$56l(E))}}return Z},On=function(G,E,F,p,$){var O=p.min($),o=p.max($),L=new aj(o.x,O.y),d=new aj(O.x,o.y),u=os(G,E,F,O,L),j=os(G,E,F,L,o),K=os(G,E,F,o,d),V=os(G,E,F,d,O),i=new Jr(m);return i.$57l(u.points),i.$57l(j.points),i.$57l(K.points),i.$57l(V.points),i.points.length>0&&(i.$62l=S),i},yg=function(R,r,$,G,M,g){var Z,P,b,f,y,d,F,p,c,i,s=M.min(g),J=M.max(g),l=new Jr(m);Z=R.$55l(-1),P=r.$55l(3),b=$.$55l(-3),f=Z.add(P.add(b.add(G))),y=new zo(f.x,f.y),Z=R.$55l(3),P=r.$55l(-6),b=$.$55l(3),f=Z.add(P.add(b)),d=new zo(f.x,f.y),Z=R.$55l(-3),P=r.$55l(3),b=Z.add(P),F=new zo(b.x,b.y),p=new zo(R.x,R.y),i=new zo(M.y-g.y,g.x-M.x),c=M.x*g.y-g.x*M.y;for(var U=new Kn(i.$60l(y),i.$60l(d),i.$60l(F),i.$60l(p)+c).$51l(),O=0;O<U.length;O++){var k=U[O];if(k>=0&&1>=k){var o=R.lerp(r,k),X=r.lerp($,k),I=$.lerp(G,k),u=o.lerp(X,k),t=X.lerp(I,k),v=u.lerp(t,k);M.x==g.x?s.y<=v.y&&v.y<=J.y&&(l.$62l=S,l.$56l(v)):M.y==g.y?s.x<=v.x&&v.x<=J.x&&(l.$62l=S,l.$56l(v)):v.gte(s)&&v.lte(J)&&(l.$62l=S,l.$56l(v))}}return l},Cq=function(x,H,i,J,y,c){var o=y.min(c),d=y.max(c),F=new aj(d.x,o.y),R=new aj(o.x,d.y),j=yg(x,H,i,J,o,F),k=yg(x,H,i,J,F,d),n=yg(x,H,i,J,d,R),I=yg(x,H,i,J,R,o),M=new Jr(m);return M.$57l(j.points),M.$57l(k.points),M.$57l(n.points),M.$57l(I.points),M.points.length>0&&(M.$62l=S),M},ab=function(t,z,B,k){var P=B.min(k),v=B.max(k),I=new aj(v.x,P.y),c=new aj(P.x,v.y),X=zf(P,I,t,z),d=zf(I,v,t,z),h=zf(v,c,t,z),A=zf(c,P,t,z),x=new Jr(m);return x.$57l(X.points),x.$57l(d.points),x.$57l(h.points),x.$57l(A.points),x.points.length>0&&(x.$62l=S),x},Ko=G.XEditInteractor=function(p){var J=this,h=J._view=document.createElement("canvas");h.className="editCanvas",h.style.position="absolute",Ko.superClass.constructor.call(J,p)};E.def(Ko,G.Interactor,{ms_edit:1,setUp:function(){var O=this,d=O.gv,W=d.getView(),o=O._view;Ko.superClass.setUp.call(O),d.setEditInteractor(O),d.$14l=o,d._79O?W.insertBefore(o,d._79O):W.appendChild(o);var H=O.$49l=O.$11l.bind(O);d.dm().md(H),d.sm().ms(H),d.mp(H)},tearDown:function(){var E=this,e=E.gv,Z=e.getView(),$=E.$49l;Ko.superClass.tearDown.call(E),e.setEditInteractor(H),e.$14l=H,Z.removeChild(E._view),e.dm().umd($),e.sm().ums($),e.ump($)},clear:function(){var C=this,m=C.gv;delete C._hoverSegmentIndex,delete C._edge,delete C._shape,delete m._editing,delete C.$10l,delete C.$13l,delete C.$9l,delete C._removePointIndex,delete C._lp,C.$12l="",delete C.$40l,delete C.$67l,delete C.$72l,delete C.$73l,delete C.$75l,delete C.$1l,delete C.$3l,delete C.$2l,delete C.$92l,delete C.$93l,delete C.$94l,C.clearDragging()},handle_keydown:function(H){this.$48l!==H.shiftKey&&(this.$48l=H.shiftKey,this.handle_mousemove(H,x,!0))},handle_keyup:function(S){this.$48l!==S.shiftKey&&(this.$48l=S.shiftKey,this.handle_mousemove(S,x,!0))},handle_touchstart:function(y){this.handle_mousemove(y),this.handle_mousedown(y)},handle_mousedown:function(l){u(l);var f=this,t=f.$13l,B=f.gv,L=B.dm(),J=B.sm(),r=B.getZoom(),H=B.lp(l),U=E.isDoubleClick(l),a=E.isLeftButton(l),V=f.$7l,K=f._shape,g=f._hoverSegmentIndex,$=f._edge,Y=f.$87l,G=f.$88l,c=function(){f._68I||Y===f.$87l&&G===f.$88l||f.$43l()};if(7!==f.$67l&&(delete f.$87l,delete f.$88l),a&&(K||$)&&g>=0&&U&&(K&&J.contains(K)||$&&J.contains($))){var s=yp.call(f,K||$,g,H);return f.addShapePoint(K||$,g,s),h(function(){f.handle_mousemove(l)},40),void 0}if(a&&(K||$)&&f._removePointIndex>=0&&U)return f.removeShapePoint(),f.$5l=1,h(function(){f.handle_mousemove(l)},40),void 0;if(!a||!B._editing)return c(),void 0;if(K&&t>=0){var Z=K.getPoints().get(t),o=K.p(),X=Yo(o,Z.x-o.x,Z.y-o.y,-V+K.getRotation());F=Yo(o,H.x-o.x,H.y-o.y,-V),f.$24l={x:F.x-X.x,y:F.y-X.y},f.startDragging(l),L.beginTransaction(),f.fi({kind:"beginEditPoint",event:l,data:K,index:t}),f.$88l=t,f.$87l=K}else if(f.$10l){var T=B.sm().getSelection(),j=f.$6l,I=f.$1l={},N=f.$3l={},x=f.$16l[i[f.$10l]],p={x:j.x,y:j.y},R={x:j.x+j.width/2,y:j.y+j.height/2};f.$24l={x:H.x-x.x/r,y:H.y-x.y/r},f.$2l=d(f.$8l),f.$4l=d(j),T.each(function(O){if(O instanceof D){var f=O.p(),z=O.getWidth(),Y=O.getHeight(),u=Yo(R,f.x-R.x,f.y-R.y,-V);I[O.getId()]={x:f.x-z/2,y:f.y-Y/2,width:z,height:Y},N[O.getId()]={x:(u.x-p.x)/j.width,y:(u.y-p.y)/j.height}}}),f.startDragging(l),L.beginTransaction(),f.fi({kind:"beginEditRect",event:l,direction:f.$10l})}else if($&&t>=0){var M=Aq(B.getDataUI($),$.s("edge.points")),Z=M.get(t);f.$24l={x:H.x-Z.x,y:H.y-Z.y},f.startDragging(l),L.beginTransaction(),f.fi({kind:"beginEditPoint",event:l,data:$,index:t}),f.$88l=t,f.$87l=$}else if(f.$40l){var j=f.$6l,R={x:j.x+j.width/2,y:j.y+j.height/2},z=d(f.$23l);z.x/=r,z.y/=r;var Q=Yo(R,z.x-R.x,z.y-R.y,-V),F=Yo(R,H.x-R.x,H.y-R.y,-V);f.$24l={x:F.x-Q.x,y:F.y-Q.y},f.startDragging(l),L.beginTransaction(),f.fi({kind:"beginEditRotation",event:l,data:f._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(f.$67l)>=0){var q=f.$67l;(7===q||8===q||9===q)&&L.beginTransaction(),f.startDragging(l)}else if(f.$71l&&U&&f.$79l(f.$71l,H)){var e=J.toSelection();L.beginTransaction(),e.each(function(w){L.remove(w)}),L.endTransaction()}c()},$11l:function(){var X=this,L=X.gv;L._editing&&(X.$13l==H||X._shape==H&&X._edge==H)&&(X.$73l==H||1!==X.$67l&&5!==X.$67l&&6!==X.$67l)||(X.$5l=1),X._68I=1},$46l:function(S){var Y=this,M=Y.gv,x=M.lp(S),B=[];return Ij(M,function(s){var w=M.getDataUI(s);if(w){var A=w._79o();j(A,x)&&B.push(s)}}),B},$47l:function(h){var v=this,o=v.$13l,b=v.gv.dm();v.$10l?(v.fi({kind:"endEditRect",event:h,direction:v.$10l}),b.endTransaction()):v._shape&&o>=0?(v.fi({kind:"endEditPoint",event:h,data:v._shape,index:o}),b.endTransaction()):v._edge&&o>=0?(v.fi({kind:"endEditPoint",event:h,data:v._edge,index:o}),b.endTransaction()):v.$23l&&v.$40l&&(v.fi({kind:"endEditRotation",event:h}),b.endTransaction())},handleWindowTouchEnd:function(v){this.handleWindowMouseUp(v)},handleWindowMouseUp:function(e){var q=this,w=q.gv,t=w.dm(),y=q._shape,l=q._edge,z=q.$13l,U=q.$40l,b=q.$9l,j=q.$10l,E=q.$67l;if((y||l)&&z>=0&&b>=0){var p,S;if(y){var C=y.p(),d=y.getRotation();p=y.getPoints(),S=p.get(b),er(y,C,d,z,S,!1)}else if(p=Aq(w.getDataUI(l),l.s("edge.points"),!0),S=p.get(b),0===z){var A=p.get(0);l.s("edge.source.offset.x",S.x-A.x),l.s("edge.source.offset.y",S.y-A.y)}else if(z===p.size()-1){var u=p.get(p.size()-1);l.s("edge.target.offset.x",S.x-u.x),l.s("edge.target.offset.y",S.y-u.y)}else"points"===l.s("edge.type")&&(p.set(z,S),l.s("edge.points",Cc(p)))}q.$47l(e);var N=q.$73l;1===E?(t.beginTransaction(),N?w.sm().each(function(R){if(R.setHost&&w.isHelperEditable(R,"host")){R.setHost(N);
var Z=q.$75l,D=q.$74l;Z&&(R.s("attach.row.index",Z.rowIndex),R.s("attach.column.index",Z.columnIndex)),D&&(R.s("attach.index",D.attachIndex),R.s("attach.offset",D.attachOffset),R.s("attach.offset.relative",!1),R.s("attach.offset.opposite",!1))}}):w.sm().each(function(Y){Y.setHost&&w.isHelperEditable(Y,"host")&&(Y.setHost(H),Y.s("attach.row.index",x),Y.s("attach.column.index",x),Y.s("attach.index",x),Y.s("attach.offset",x),Y.s("attach.offset.relative",!1),Y.s("attach.offset.opposite",!1))}),t.endTransaction()):2===E?(t.beginTransaction(),N?w.sm().each(function(T){T.setParent&&w.isHelperEditable(T,"parent")&&T.setParent(N)}):w.sm().each(function(c){c.setParent&&w.isHelperEditable(c,"parent")&&c.setParent(H)}),t.endTransaction()):3===E?N&&(t.beginTransaction(),w.sm().each(function(f){if(w.isHelperEditable(f,"edge")&&f instanceof D&&N instanceof D){var h=new r.Edge;t.add(h),h.setSource(f),h.setTarget(N),q.onEdgeCreated&&q.onEdgeCreated(e,h)}}),t.endTransaction()):5===E||6===E?N&&(t.beginTransaction(),w.sm().each(function(K){K instanceof c&&N instanceof D&&(5===E&&w.isHelperEditable(K,"source")?K.setSource(N):6===E&&w.isHelperEditable(K,"source")&&K.setTarget(N))}),t.endTransaction()):(7===E||8===E||9===E)&&t.endTransaction(),(j||U)&&q.$43l(!0),k?(q.clear(),delete q.$64l,q._68I||q.$43l()):(q.handle_mousemove(e,!0),E&&!q._68I&&q.$43l())},handleWindowTouchMove:function(n){this.handleWindowMouseMove(n)},handleWindowMouseMove:function(A){this._78I(A)},handle_mousemove:function(C,e,I){if(!this._pause){if(!I){var R=k?po(C):C;this.$61l={clientX:R.clientX,clientY:R.clientY}}if(e===!0||!Z()){var v=this,j=v.gv,a=!1,w=H;v.clear(),j.sm().size()>0&&(w=j.lp(I?v.$61l:C),a=v._79I(C,w)),a&&(j._editing=1),v.$12l!==v.$65l&&(v.$65l=v.$12l,v.setCursor(v.$12l)),v.$40l!==v.$64l&&(v.$64l=v.$40l,v._68I||v.$43l()),v._hoverSegmentIndex!==v.$66l&&(v.$66l=v._hoverSegmentIndex,v._68I||v.$43l())}}},_78I:function(i){this.autoScroll(i);var $=this,n=$.gv,C=n.lp(i),s=n.getZoom(),z=$.$13l;if(($._shape||$._edge)&&z>=0){var u,e,m,j=$._shape,d=$._edge,P=$.$24l,O=n.getPointSnapSpacing(),f=function(z,V){return O==H||isNaN(O)?{x:z,y:V}:{x:w(z/O)*O,y:w(V/O)*O}};if(j){u=j.getPoints();var G=j.p(),J=j.getRotation(),X=0;e=Yo(G,C.x-G.x,C.y-G.y,-J),er(j,G,J,z,C,!0,P,f),$.fi({kind:"betweenEditPoint",event:i,data:j,index:z})}else if(d){u=Aq(n.getDataUI(d),d.s("edge.points"),!0),C.x-=P.x,C.y-=P.y,e=C;var b,I,M=d.s("edge.offset"),v=u.size(),_=v>2;if(0===z){var t=u.get(0);M&&(t=Mq(t,u.get(1),-M,_),C=Mq(C,u.get(1),-M,_)),b=C.x-t.x,I=C.y-t.y,m=f(b,I),d.s("edge.source.offset.x",m.x),d.s("edge.source.offset.y",m.y)}else if(z===v-1){var q=u.get(v-1);M&&(q=Mq(q,u.get(v-2),-M,_),C=Mq(C,u.get(v-2),-M,_)),b=C.x-q.x,I=C.y-q.y,m=f(b,I),d.s("edge.target.offset.x",m.x),d.s("edge.target.offset.y",m.y)}else"points"===d.s("edge.type")&&(m=f(C.x,C.y),m.e=u.get(z).e,u.set(z,m),d.s("edge.points",Cc(u)));$.fi({kind:"betweenEditPoint",event:i,data:d,index:z})}if(delete $.$9l,n.isSnapPoint(j)||n.isSnapPoint(d))for(X=0;X<u.size();X++)if(X!==z){var p=u.get(X);if(y(p,e)<n.getEditPointSize()/s){$.$9l=X;break}}}else if($.$10l){var P=$.$24l;C.x-=P.x,C.y-=P.y;var Y=n.sm().getSelection(),k=$.$1l,x=$.$7l,r=$.$10l,R=$.$4l,B=$.$2l,S=n.getEditRectPadding()/s,Q=2*S,V=n.getSnapSpacing(),L=V!=H&&!isNaN(V),o=Fd(B,C,r,x,2*S,n.getResizeMode(),L,!0),W=$.$6l;if(L){var a=o.width-Q,U=o.height-Q,Z=w(a/V)*V,Go=w(U/V)*V,us=Z-a,mc=Go-U;("west"===r||"northwest"===r||"southwest"===r)&&(us=-us),("north"===r||"northwest"===r||"northeast"===r)&&(mc=-mc),o=Fd(B,C,r,x,2*S,n.getResizeMode(),L,!1,us,mc)}$.$8l=o,W.x=o.x+S,W.y=o.y+S,W.width=o.width-Q,W.height=o.height-Q;var Zi=o.x+o.width/2,Yk=o.y+o.height/2,Bi=W.x,mp=W.y,Dn=W.width/R.width,yq=W.height/R.height;Y.each(function(T){if(T instanceof D&&n.isEditable(T)&&n.isRectEditable(T)){var P=k[T.getId()],K=$.$3l[T.getId()],c={x:P.x+P.width/2,y:P.y+P.height/2},X=0,Q=0,O=r,p=180*F(x-T.getRotation())/l;"northeast"===r?p>=315||45>p?(X=P.width*Dn+P.x,Q=P.height*(1-yq)+P.y,O="northeast"):p>=45&&135>p?(X=P.width*(1-yq)+P.x,Q=P.height*(1-Dn)+P.y,O="northwest"):p>=135&&225>p?(X=P.width*(1-Dn)+P.x,Q=P.height*yq+P.y,O="southwest"):(X=P.width*yq+P.x,Q=P.height*Dn+P.y,O="southeast"):"north"===r?p>=315||45>p?(Q=P.height*(1-yq)+P.y,O="north"):p>=45&&135>p?(X=P.width*(1-yq)+P.x,O="west"):p>=135&&225>p?(Q=P.height*yq+P.y,O="south"):(X=P.width*yq+P.x,O="east"):"northwest"===r?p>=315||45>p?(X=P.width*(1-Dn)+P.x,Q=P.height*(1-yq)+P.y,O="northwest"):p>=45&&135>p?(X=P.width*(1-yq)+P.x,Q=P.height*Dn+P.y,O="southwest"):p>=135&&225>p?(X=P.width*Dn+P.x,Q=P.height*yq+P.y,O="southeast"):(X=P.width*yq+P.x,Q=P.height*(1-Dn)+P.y,O="northeast"):"west"===r?p>=315||45>p?(X=P.width*(1-Dn)+P.x,O="west"):p>=45&&135>p?(Q=P.height*Dn+P.y,O="south"):p>=135&&225>p?(X=P.width*Dn+P.x,O="east"):(Q=P.height*(1-Dn)+P.y,O="north"):"southwest"===r?p>=315||45>p?(X=P.width*(1-Dn)+P.x,Q=P.height*yq+P.y,O="southwest"):p>=45&&135>p?(X=P.width*yq+P.x,Q=P.height*Dn+P.y,O="southeast"):p>=135&&225>p?(X=P.width*Dn+P.x,Q=P.height*(1-yq)+P.y,O="northeast"):(X=P.width*(1-yq)+P.x,Q=P.height*(1-Dn)+P.y,O="northwest"):"east"===r?p>=315||45>p?(X=P.width*Dn+P.x,O="east"):p>=45&&135>p?(Q=P.height*(1-Dn)+P.y,O="north"):p>=135&&225>p?(X=P.width*(1-Dn)+P.x,O="west"):(Q=P.height*Dn+P.y,O="south"):"south"===r?p>=315||45>p?(Q=P.height*yq+P.y,O="south"):p>=45&&135>p?(X=P.width*yq+P.x,O="east"):p>=135&&225>p?(Q=P.height*(1-yq)+P.y,O="north"):(X=P.width*(1-yq)+P.x,O="west"):"southeast"===r&&(p>=315||45>p?(X=P.width*Dn+P.x,Q=P.height*yq+P.y,O="southeast"):p>=45&&135>p?(X=P.width*yq+P.x,Q=P.height*(1-Dn)+P.y,O="northeast"):p>=135&&225>p?(X=P.width*(1-Dn)+P.x,Q=P.height*(1-yq)+P.y,O="northwest"):(X=P.width*(1-yq)+P.x,Q=P.height*Dn+P.y,O="southwest"));var I=Yo(c,X-c.x,Q-c.y,T.getRotation());$k(T,P,O,{x:I.x,y:I.y});var E=Bi+W.width*K.x,J=mp+W.height*K.y,N={x:E,y:J};N=Yo({x:Zi,y:Yk},N.x-Zi,N.y-Yk,x),T.p(N.x,N.y)}}),$.fi({kind:"betweenEditRect",event:i,direction:r})}else if($.$23l&&$.$40l){var Wb=$.$8l,Ln=Wb.width,le=Wb.height,G={x:Wb.x+Ln/2,y:Wb.y+le/2},P=$.$24l,Xf=$.$23l,Db=Xf.x/s-G.x,ao=Xf.y/s-G.y,ab=T(Db*Db+ao*ao),pk=Math.asin(P.x/ab),Pg=n.sm().getSelection(),de=g+K(C.y-G.y,C.x-G.x)-pk,Ck=n.getSnapAngle(),de=w(de/Ck)*Ck;0>de&&(de+=N);var Jo=de-$.$7l,uq=[G.x,0,G.y];Pg.each(function(a){if(n.isEditable(a)&&n.isRotationEditable(a)&&n.isVisible(a)){var Q=sb(a.p3(),uq),v=xp();mf(v,-Jo),a.setRotation(a.getRotation()+Jo),ub(Q,v),a.p3(uq[0]+Q[0],uq[1]+Q[1],uq[2]+Q[2])}}),$.$7l=de,$.fi({kind:"betweenEditRotation",event:i})}else if([1,2,3,5,6].indexOf($.$67l)>=0)$.$72l=i,$.$78l||($.$78l=1,h(function(){E.isDragging()&&$.$43l(),delete $.$78l},12));else if(7===$.$67l){if($.$87l instanceof A){var j=$.$87l,sl=$.$88l,Yb=E.clone(j.getPoints().get(sl)),hg=C.y-Yb.y;Yb.e||(Yb.e=0),$.$92l||($.$92l=Yb.e),Yb.e=$.$92l-hg,j.setPoint(sl,Yb)}else if($.$87l instanceof c){var d=$.$87l,sl=$.$88l,u=Aq(n.getDataUI(d),d.s("edge.points")),Yb=u.get(sl),hg=C.y-Yb.y;Yb.e||(Yb.e=0),$.$92l||($.$92l=Yb.e),Yb.e=$.$92l-hg,u.set(sl,Yb),d.s("edge.points",Cc(u))}}else if(8===$.$67l){var Pg=n.sm().getSelection(),tg=$.$93l;tg||(tg=$.$93l={}),Pg.each(function(a){if(a.p3){var F=a.p3(),h=tg[a.getId()];h==H&&(h=tg[a.getId()]=F[1]),a.p3([F[0],h-(C.y-$.$90l.y/s),F[2]])}})}else if(9===$.$67l){var Pg=n.sm().getSelection(),Cd=$.$94l;Cd||(Cd=$.$94l={}),Pg.each(function(p){if(p.s3){var n=p.s3(),K=Cd[p.getId()];K==H&&(K=Cd[p.getId()]=n[1]);var E=K-(C.y-$.$91l.y/s);0>E&&(E=.01),p.s3([n[0],E,n[2]])}})}},$79l:function(Y,z){var k=this,x=k.gv,C=x.getZoom(),I=x.getEditHelperSize(),W=Y.x/C,L=Y.y/C,K=I/C,R=K/2;return j({x:W-R,y:L-R,width:K,height:K},z)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(s,f){for(var g=this,a=g.gv,v=a.getZoom(),r=a.getEditPointSize(),N=r/v,E=N/2,l=g.$46l(s),h=0;h<l.length;h++){var Q,_,L=l[h],p=a.getDataUI(L);if(p&&p._55O){var O=p._55O;if(O._43O&&L instanceof c){if(Q=L.s("edge.points"),Q=Aq(p,Q),_=L.s("edge.segments"),_&&_.size()||(_=Xp(Q)),g.$42l(L,f,Q._as,_,"edge"))return!0;if("points"===L.s("edge.type")&&g.$41l(L,f,Q._as,_,"edge"))return}if(O._43O&&L instanceof A&&O.$15l&&O.$15l.length===L.getPoints().size()){if(Q=O.$15l,_=L.getSegments(),_&&_.size()||(_=Xp(Q)),g.$42l(L,f,Q,_,"shape"))return!0;if(g.$41l(L,f,Q,_,"shape"))return}}}if(g.$16l){var Q,X=g.$16l,F=X[3].x-X[7].x,M=X[3].y-X[7].y,V=T(F*F+M*M),I=X[1].x-X[5].x,K=X[1].y-X[5].y,S=T(I*I+K*K),D={x:f.x*v,y:f.y*v};if(g._80I(D,0,X[0],"northwest",V,S)||g._80I(D,1,X[1],"north",V,S)||g._80I(D,2,X[2],"northeast",V,S)||g._80I(D,7,X[7],"west",V,S)||g._80I(D,3,X[3],"east",V,S)||g._80I(D,6,X[6],"southwest",V,S)||g._80I(D,5,X[5],"south",V,S)||g._80I(D,4,X[4],"southeast",V,S))return!0}if(g.$23l){var o=g.$23l,C=o.x/v,z=o.y/v;if(j({x:C-E,y:z-E,width:N,height:N},f))return g.$40l=1,g.$12l=g.getHelperCursor("rotation")||"crosshair",!0}return g.$68l&&g.$79l(g.$68l,f)?(g.$67l=1,g.$12l=g.getHelperCursor("host")||"crosshair",!0):g.$69l&&g.$79l(g.$69l,f)?(g.$67l=2,g.$12l=g.getHelperCursor("parent")||"crosshair",!0):g.$70l&&g.$79l(g.$70l,f)?(g.$67l=3,g.$12l=g.getHelperCursor("edge")||"crosshair",!0):g.$71l&&g.$79l(g.$71l,f)?(g.$67l=4,g.$12l=g.getHelperCursor("remove")||"crosshair",!0):g.$82l&&g.$79l(g.$82l,f)?(g.$67l=5,g.$12l=g.getHelperCursor("source")||"crosshair",!0):g.$83l&&g.$79l(g.$83l,f)?(g.$67l=6,g.$12l=g.getHelperCursor("target")||"crosshair",!0):g._pointElevationHelperPoint&&g.$79l(g._pointElevationHelperPoint,f)?(g.$67l=7,g.$12l=g.getHelperCursor("pointElevation")||"crosshair",!0):g.$90l&&g.$79l(g.$90l,f)?(g.$67l=8,g.$12l=g.getHelperCursor("elevation")||"crosshair",!0):g.$91l&&g.$79l(g.$91l,f)?(g.$67l=9,g.$12l=g.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(U,T,n,u,C,h){var w=this,q=w.gv,y=q.getEditPointSize(),E=y/2,f=q.sm(),G=q.isDirectionEditable;if(G&&1===f.size()){var t=f.ld();if(G=G.bind(q),t instanceof D){if(!G(t,u))return!1;if("east"===u){if(G(t,"northeast")&&G(t,"southeast")&&2*y>=h)return!1}else if("west"===u){if(G(t,"northwest")&&G(t,"southwest")&&2*y>=h)return!1}else if("north"===u){if(G(t,"northwest")&&G(t,"northeast")&&2*y>=C)return!1}else if("south"===u&&G(t,"southwest")&&G(t,"southeast")&&2*y>=C)return!1}}else{if(2*y>=C&&("north"===u||"south"===u))return!1;if(2*y>=h&&("east"===u||"west"===u))return!1}if(j({x:n.x-E,y:n.y-E,width:y,height:y},U)){if(w.$10l!==u){var H=180*w.$7l/l,s="";H>=337.5||22.5>H?s="north":H>=22.5&&67.5>H?s="northeast":H>=67.5&&112.5>H?s="east":H>=112.5&&157.5>H?s="southeast":H>=157.5&&202.5>H?s="south":H>=202.5&&247.5>H?s="southwest":H>=247.5&&292.5>H?s="west":H>=292.5&&337.5>H&&(s="northwest");var W=hs.indexOf(s),s=hs[T-(1-W)+8];switch(s){case"northwest":w.$12l="nwse-resize";break;case"northeast":w.$12l="nesw-resize";break;case"southwest":w.$12l="nesw-resize";break;case"southeast":w.$12l="nwse-resize";break;case"north":w.$12l="ns-resize";break;case"east":w.$12l="ew-resize";break;case"south":w.$12l="ns-resize";break;case"west":w.$12l="ew-resize"}w.$10l=u}return!0}return!1},$42l:function(C,r,o,s,R){var n,f=this,I=f.gv,t=I.getEditPointSize(),Z=t/I.getZoom(),y=-1,z={x:r.x,y:r.y,width:0,height:0},m=function(o){"shape"===R?f._shape=C:f._edge=C,f._removePointIndex=o},N=function(_){"shape"===R?f._shape=C:f._edge=C,f.$13l=_,f.$12l="crosshair"};for(q(z,Z/2),y=o.length-1,n=s.size()-1;n>=0;n--){var c=s.get(n);if(1===c||2===c)y-=1;else if(3===c){var T=o[y-1];if(j(z,T))return N(y-1),!0;y-=2}else if(4===c){var P=o[y-1],e=o[y-2];if(j(z,P))return N(y-1),!0;if(j(z,e))return N(y-2),!0;y-=3}}for(y=o.length-1,n=s.size()-1;n>=0;n--){var c=s.get(n),B=o[y];if(j(z,B))return m(y),N(y),!0;1===c||2===c?y-=1:3===c?y-=2:4===c&&(y-=3)}return!1},$41l:function($,p,r,Z,H){var l=this,C=l.gv,e=-1,K=0,s={x:p.x,y:p.y,width:0,height:0},h=function(E,P){l._hoverSegmentIndex=P,l._lp=p,"shape"===H?l._shape=$:l._edge=$};for(q(s,C.getSegmentHoverWidth()/2/C.getZoom()),$ instanceof A&&$.isClosePath()&&Z.indexOf(5)<0&&(Z=new a(Z._as),Z.add(5));K<Z.size();K++){var d=Z.get(K);if(1===d){var g=r[e],k=r[e+1];if(g){var n=ab(new aj(g.x,g.y),new aj(k.x,k.y),new aj(s.x,s.y),new aj(s.x+s.width,s.y+s.height));if(n.$62l===S&&n.points.length>0)return h(n,K),!0}e+=1}else if(2===d){var g=r[e],k=r[e+1],n=ab(new aj(g.x,g.y),new aj(k.x,k.y),new aj(s.x,s.y),new aj(s.x+s.width,s.y+s.height));if(n.$62l===S&&n.points.length>0)return h(n,K),!0;e+=1}else if(3===d){var g=r[e],I=r[e+1],j=r[e+2],n=On(new aj(g.x,g.y),new aj(I.x,I.y),new aj(j.x,j.y),new aj(s.x,s.y),new aj(s.x+s.width,s.y+s.height));if(n.$62l===S)return h(n,K),!0;e+=2}else if(4===d){var g=r[e],U=r[e+1],P=r[e+2],j=r[e+3],n=Cq(new aj(g.x,g.y),new aj(U.x,U.y),new aj(P.x,P.y),new aj(j.x,j.y),new aj(s.x,s.y),new aj(s.x+s.width,s.y+s.height));if(n.$62l===S)return h(n,K),!0;e+=3}else if(5===d){var g=r[e],k=r[0];if(g){var n=ab(new aj(g.x,g.y),new aj(k.x,k.y),new aj(s.x,s.y),new aj(s.x+s.width,s.y+s.height));if(n.$62l===S&&n.points.length>0)return h(n,K),!0}}}return!1},addShapePoint:function(I,h,K){var r=this,p=r.gv,i=p.dm();if(i.beginTransaction(),0===arguments.length&&(I=r._shape||r._edge,h=r._hoverSegmentIndex,K=r._lp),I instanceof A||I instanceof c){var t=ce(I,p.getDataUI(I),h);if(!isNaN(h)&&K&&!isNaN(t)){var j=K;if(I instanceof A){var E=I.p(),$=I.getRotation(),N=I.toSegments();N&&N.size()||(N=Xp(I.getPoints())),I.isClosePath()&&N.indexOf(5)<0&&(N=new a(N._as),N.add(5));var V=N.get(h),q="addPoint",x="removePointAt";if(2===V||1===V){var o={x:j.x,y:j.y};N.add(V,h),o=Yo(E,o.x-E.x,o.y-E.y,-$),I[q](o,t+1)}else if(3===V){var k=I.getPoints(),U=k.get(t),L=k.get(t+2),o={x:j.x,y:j.y};o=Yo(E,o.x-E.x,o.y-E.y,-$);var f=Vd(U,o),v=Vd(o,L);N.removeAt(h),N.add(3,h),N.add(3,h),I.setPoint(t+1,o),I[q](v,t+2),I[q](f,t+1)}else if(4===V){var k=I.getPoints(),U=k.get(t),L=k.get(t+3),o={x:j.x,y:j.y};o=Yo(E,o.x-E.x,o.y-E.y,-$);var f=mr(U,o),v=ul(U,o),P=mr(o,L),u=ul(o,L);N.removeAt(h),N.add(4,h),N.add(4,h),I[x](t+1),I[x](t+1),I[q](o,t+1),I[q](u,t+2),I[q](P,t+2),I[q](v,t+1),I[q](f,t+1)}else if(5===V){var o={x:j.x,y:j.y};N.add(2,h),o=Yo(E,o.x-E.x,o.y-E.y,-$),I[q](o,t+1)}I.isClosePath()&&N.remove(5),I.setSegments(N);var s=I.getWidth(),z=I.getHeight(),C=I.p().x-s/2,F=I.p().y-z/2;C-=E.x,F-=E.y;var H=oe(I,{x:C,y:F,width:s,height:z},$,E);I.p(H.x,H.y)}else if(I instanceof c){if("points"!==I.s("edge.type"))return i.endTransaction(),void 0;var k=I.s("edge.points");N=I.s("edge.segments"),k=Aq(p.getDataUI(I),k),N&&N.size()||(N=Xp(k)),N=new a(N._as.slice(0)),k=new a(k._as.slice(0));var V=N.get(h);if(2===V||1===V){var o={x:j.x,y:j.y};N.add(V,h),k.add(o,t+1)}else if(3===V){var U=k.get(t),L=k.get(t+2),o={x:j.x,y:j.y},f=Vd(U,o),v=Vd(o,L);N.removeAt(h),N.add(3,h),N.add(3,h),k.set(t+1,o),k.add(v,t+2),k.add(f,t+1)}else if(4===V){var U=k.get(t),L=k.get(t+3),o={x:j.x,y:j.y},f=mr(U,o),v=ul(U,o),P=mr(o,L),u=ul(o,L);N.removeAt(h),N.add(4,h),N.add(4,h),k.removeAt(t+1),k.removeAt(t+1),k.add(o,t+1),k.add(u,t+2),k.add(P,t+2),k.add(v,t+1),k.add(f,t+1)}I.s("edge.points",Cc(k)),I.s("edge.segments",N)}}}i.endTransaction()},removeShapePoint:function(g,M){var D=this,J="removeAt",C=D.gv,T=C.dm();if(T.beginTransaction(),0===arguments.length&&(g=D._shape||D._edge,M=D._removePointIndex),M>=0&&(g instanceof A||g instanceof c)){var s=vg(g,D.gv.getDataUI(g),M),U=M;if(g instanceof A){var W=g.p(),n=g.toSegments();n&&n.size()||(n=Xp(g.getPoints()));var _=n.get(s),p="removePointAt";if(1===_&&0===U)if(g.getPoints().size()>1){var H=n.get(s+1);n[J](s+1),3===H?g[p](U+1):4===H&&(g[p](U+2),g[p](U+1)),g[p](U)}else g.dm().remove(g);else 2===_||1===_?(n[J](s),g[p](U)):3===_?(n[J](s),g[p](U),g[p](U-1)):4===_&&(n[J](s),g[p](U),g[p](U-1),g[p](U-2));g.setSegments(n);var R=g.getWidth(),d=g.getHeight(),q=g.p().x-R/2,f=g.p().y-d/2;q-=W.x,f-=W.y;var o=oe(g,{x:q,y:f,width:R,height:d},g.getRotation(),W);g.p(o.x,o.y)}else if(g instanceof c){if("points"!==g.s("edge.type"))return T.endTransaction(),void 0;var w=g.s("edge.points");if(n=g.s("edge.segments"),w&&(w=Aq(D.gv.getDataUI(g),w),n&&n.size()||(n=Xp(w))),0===M||M===w.size()-1)return T.endTransaction(),void 0;n=new a(n._as.slice(0)),w=new a(w._as.slice(0));var _=n.get(s);2===_||1===_?(n[J](s),w[J](U)):3===_?(n[J](s),w[J](U),w[J](U-1)):4===_&&(n[J](s),w[J](U),w[J](U-1),w[J](U-2)),g.s("edge.segments",n),g.s("edge.points",Cc(w))}}T.endTransaction()},changeShapeSegment:function(f,R,$){var i=this,s=i.gv,V=s.dm();if(V.beginTransaction(),1!==arguments.length||isNaN(f)||($=f,f=i._shape||i._edge,R=i._hoverSegmentIndex),f instanceof A||f instanceof c){var E=ce(f,i.gv.getDataUI(f),R);if(!isNaN(R)&&!isNaN(E))if(f instanceof A){var I=f.p(),Z=f.toSegments();Z&&Z.size()||(Z=Xp(f.getPoints()));var O=Z.get(R),j=f.toPoints();if(1===$||2===$)1===O||2===O?Z.set(R,$):3===O?(Z.set(R,$),j.removeAt(E+1)):4===O&&(Z.set(R,$),j.removeAt(E+1),j.removeAt(E+1));else if(3===$){var v=function(){var t=j.get(E),w=j.get(E+1),A=Vd(t,w);Z.set(R,3),j.add(A,E+1)};2===O||1===O?v():4===O&&(j.removeAt(E+1),j.removeAt(E+1),v())}else if(4===$){var N=function(){var d=j.get(E),G=j.get(E+1),S=mr(d,G),s=ul(d,G);Z.set(R,4),j.add(S,E+1),j.add(s,E+2)};2===O||1===O?N():3===O&&(j.removeAt(E+1),N())}f.setSegments(Z),f.setPoints(j);var F=f.getWidth(),X=f.getHeight(),M=f.p().x-F/2,S=f.p().y-X/2;M-=I.x,S-=I.y;var d=new oe(f,{x:M,y:S,width:F,height:X},f.getRotation(),I);f.p(d.x,d.y)}else if(f instanceof c){if("points"!==f.s("edge.type"))return V.endTransaction(),void 0;var j=f.s("edge.points");Z=f.s("edge.segments"),j&&(j=Aq(i.gv.getDataUI(f),j),Z&&Z.size()||(Z=Xp(j))),Z=new a(Z._as.slice(0)),j=new a(j._as.slice(0));var O=Z.get(R);if(1===$||2===$)1===O||2===O?Z.set(R,$):3===O?(Z.set(R,$),j.removeAt(E+1)):4===O&&(Z.set(R,$),j.removeAt(E+1),j.removeAt(E+1));else if(3===$){var v=function(){var m=j.get(E),C=j.get(E+1),i=Vd(m,C);Z.set(R,3),j.add(i,E+1)};2===O||1===O?v():4===O&&(j.removeAt(E+1),j.removeAt(E+1),v())}else if(4===$){var N=function(){var F=j.get(E),u=j.get(E+1),l=mr(F,u),H=ul(F,u);Z.set(R,4),j.add(l,E+1),j.add(H,E+2)};2===O||1===O?N():3===O&&(j.removeAt(E+1),N())}f.s("edge.points",Cc(j)),f.s("edge.segments",Z)}}V.endTransaction()},getDefaultSegments:function(F){var u=this.gv,M=u.getDataUI(F);if(F instanceof c){var Q=F.s("edge.points");return Q=Aq(M,Q),Xp(Q)}if(F instanceof A){var Q=F.getPoints(),q=F.getSegments();return q&&q.size()>0?q:Xp(Q)}},$43l:function(K){var z=this;K&&(z.$5l=1),z._68I=1,z._42()},_42:function(){var P=this;if(P._68I){delete P._68I;var y=P.gv,k=P.$5l,w=y.getZoom(),J=y.getEditPointSize(),S=J/2,o=new a,I=P._view,B=P._edge,f=P._shape,X=I.getContext("2d"),i=y.tx(),U=y.ty(),n=H,K=y.getEditPointBackground(),Q=y.getControlPointBackground(),Z=y.getControlPointBorderColor(),$=y.getEditPointBorderColor(),G=y.getEditRectBorderColor(),v=y.getDirectionLineColor(),e=y.getSegmentHoverColor(),x=y.getSnapPointBorderColor(),L=y.getJoinPointBackground(),p=y.getJoinPointBorderColor(),W=y.getSegmentHoverWidth(),h=[5,5],m=y.getEditRectBorderStyle();Wp(y,function(L){y.isSelected(L)&&y.isVisible(L)&&o.add(L)}),X.clearRect(0,0,R(I.width),R(I.height)),X.save(),t.translateAndScale(X,i,U,1);var V=H,g={x:0,y:0,width:0,height:0},j=0,F=0,Y=0,z=0,l=0,u=0,vk=0,hq=0,Oo=0,Fo=0,Hn=[];if(k?(delete P.$6l,delete P.$8l,delete P.$7l,delete P.$16l,delete P.$23l):(V=P.$6l,n=P.$7l),delete P.$68l,delete P.$69l,delete P.$71l,delete P.$70l,delete P.$82l,delete P.$83l,delete P._pointElevationHelperPoint,delete P.$90l,delete P.$91l,delete P.$75l,delete P.$74l,o.each(function(h){var a=y.getDataUI(h);if(a){var K=a._55O;if(y.isEditable(h))K._56O&&h instanceof D&&F++,Hn.push(h),K._42O&&h instanceof D&&j++,y.isHelperEditable(h,"host")&&z++,y.isHelperEditable(h,"parent")&&Y++,y.isHelperEditable(h,"remove")&&l++,y.isHelperEditable(h,"edge")&&u++,y.isHelperEditable(h,"source")&&vk++,y.isHelperEditable(h,"target")&&hq++,y.isHelperEditable(h,"elevation")&&Oo++,y.isHelperEditable(h,"tall")&&Fo++;else if(h instanceof O&&h.isExpanded()){var $=!0,r=y.getEditableFunc();r&&($=r(h)),$&&(y.isHelperEditable(h,"host")&&z++,y.isHelperEditable(h,"parent")&&Y++,y.isHelperEditable(h,"remove")&&l++,y.isHelperEditable(h,"edge")&&u++,y.isHelperEditable(h,"source")&&vk++,y.isHelperEditable(h,"target")&&hq++,y.isHelperEditable(h,"elevation")&&Oo++,y.isHelperEditable(h,"tall")&&Fo++,Hn.push(h))}}}),X.beginPath(),X.lineWidth=1,X.strokeStyle=y.getNodeBorderColor(),Hn.forEach(function(o){var R=y.getDataUI(o),p=R._55O;if(k)if(n==H&&(n=o instanceof c?0:o instanceof O&&o.isExpanded()?0:o.getRotation(),P.$7l=n),V==H){var K,f,s;if(o instanceof O&&o.isExpanded()||o instanceof c){var S=y.getDataUIBounds(o);f=S.width,s=S.height,K={x:S.x+f/2,y:S.y+s/2}}else K=o.p(),f=o.getWidth(),s=o.getHeight();V={x:K.x,y:K.y,width:0,height:0},g.x=K.x-f/2,g.y=K.y-s/2,g.width=f,g.height=s,V=C(V,g)}else{var K,f,s,F,G=V.x+V.width/2,m=V.y+V.height/2,N={x:G,y:m};if(o instanceof O&&o.isExpanded()||o instanceof c){F=0;var S=y.getDataUIBounds(o);f=S.width,s=S.height,K={x:S.x+f/2,y:S.y+s/2}}else K=o.p(),f=o.getWidth(),s=o.getHeight(),F=o.getRotation();var l={x:K.x-f/2,y:K.y-s/2,width:f,height:s},Y={x:l.x,y:l.y},E={x:l.x+l.width,y:l.y},x={x:l.x,y:l.y+l.height},d={x:l.x+l.width,y:l.y+l.height},Y=Yo(K,Y.x-K.x,Y.y-K.y,F),x=Yo(K,x.x-K.x,x.y-K.y,F),d=Yo(K,d.x-K.x,d.y-K.y,F),E=Yo(K,E.x-K.x,E.y-K.y,F),h=-n,e=Yo(N,Y.x-N.x,Y.y-N.y,h),M=Yo(N,E.x-N.x,E.y-N.y,h),B=Yo(N,x.x-N.x,x.y-N.y,h),q=Yo(N,d.x-N.x,d.y-N.y,h),L=b([e,M,B,q]);V=C(V,L),V.x-=G,V.y-=m;var v=oe(H,V,n,N);V.x=v.x-V.width/2,V.y=v.y-V.height/2}if(j>1&&y.isEditable(o)&&y.isRectEditable(o)&&o instanceof D){var Q=o.getRect(),i=p.$45l,r=Hp(i[0],w),$=Hp(i[2],w),_=Hp(i[4],w),T=Hp(i[6],w);o.getRotation()?(X.moveTo(r.x,r.y),X.lineTo($.x,$.y),X.lineTo(_.x,_.y),X.lineTo(T.x,T.y),X.lineTo(r.x,r.y)):X.rect(Q.x*w,Q.y*w,Q.width*w,Q.height*w)}}),X.stroke(),V){P.$6l=d(V),q(V,y.getEditRectPadding()/w);var Pn={x:V.x+V.width/2,y:V.y+V.height/2},Hf=tn(Pn,V.width,V.height,n),cr=Hf[0],gj=Hf[1],_l=Hf[2],Mm=Hf[3],qr=Hf[4],_b=Hf[5],Ip=Hf[6],_h=Hf[7];if(cr=Hp(Hf[0],w),gj=Hp(Hf[1],w),_l=Hp(Hf[2],w),Mm=Hp(Hf[3],w),qr=Hp(Hf[4],w),_b=Hp(Hf[5],w),Ip=Hp(Hf[6],w),_h=Hp(Hf[7],w),P.$8l=V,j>0&&(P.$16l=[cr,qr,gj,_b,Mm,Ip,_l,_h],X.beginPath(),X.lineWidth=1,X.strokeStyle=G,"dashed"===m&&X.setLineDash&&X.setLineDash(h),X.moveTo(cr.x,cr.y),X.lineTo(gj.x,gj.y),X.lineTo(Mm.x,Mm.y),X.lineTo(_l.x,_l.y),X.lineTo(cr.x,cr.y),X.stroke(),"dashed"===m&&X.setLineDash&&X.setLineDash([])),X.beginPath(),X.lineWidth=1,X.fillStyle=K,X.strokeStyle=$,j>0){var bl=_b.x-_h.x,ol=_b.y-_h.y,jl=T(bl*bl+ol*ol),of=qr.x-Ip.x,Wb=qr.y-Ip.y,wh=T(of*of+Wb*Wb),Am=2*J;if(y.isDirectionEditable&&1===Hn.length){var dh=Hn[0],Hb=y.getDataUI(dh),Uj=Hb._55O,rb=y.isDirectionEditable.bind(y);if(Uj._42O){var Qr,Ob,Si,td;rb(dh,"northwest")&&(Qr=!0,X.rect(cr.x-S,cr.y-S,J,J)),rb(dh,"northeast")&&(Ob=!0,X.rect(gj.x-S,gj.y-S,J,J)),rb(dh,"southwest")&&(Si=!0,X.rect(_l.x-S,_l.y-S,J,J)),rb(dh,"southeast")&&(td=!0,X.rect(Mm.x-S,Mm.y-S,J,J)),rb(dh,"north")&&(Qr&&Ob?jl>Am&&X.rect(qr.x-S,qr.y-S,J,J):X.rect(qr.x-S,qr.y-S,J,J)),rb(dh,"south")&&(td&&Si?jl>Am&&X.rect(Ip.x-S,Ip.y-S,J,J):X.rect(Ip.x-S,Ip.y-S,J,J)),rb(dh,"west")&&(Si&&Qr?wh>Am&&X.rect(_h.x-S,_h.y-S,J,J):X.rect(_h.x-S,_h.y-S,J,J)),rb(dh,"east")&&(td&&Ob?wh>Am&&X.rect(_b.x-S,_b.y-S,J,J):X.rect(_b.x-S,_b.y-S,J,J))}}else jl>Am&&(X.rect(qr.x-S,qr.y-S,J,J),X.rect(Ip.x-S,Ip.y-S,J,J)),wh>Am&&(X.rect(_b.x-S,_b.y-S,J,J),X.rect(_h.x-S,_h.y-S,J,J)),X.rect(cr.x-S,cr.y-S,J,J),X.rect(gj.x-S,gj.y-S,J,J),X.rect(_l.x-S,_l.y-S,J,J),X.rect(Mm.x-S,Mm.y-S,J,J)}if(F>0){var dj=P.$23l=Yo(qr,0,2*-J,n);X.moveTo(dj.x+S,dj.y),X.arc(dj.x,dj.y,S,0,N,!1)}X.fill(),X.stroke(),P.$40l&&P.$44l(X,V,n);var Mq,wg,mq=y.getLeftTopHelpers(),gr=y.getRightTopHelpers(),yj=y.getLeftBottomHelpers(),zq=y.getRightBottomHelpers(),Ph=y.getEdgeHelpers(),fp=y.getEditHelperSize(),Xn=fp/2,Co=function(p,W,T,j){"leftTop"===W?(Mq=V.x*w-fp-S-("h"===j?T*(fp+S):0)-1,wg=V.y*w-fp-S-("v"===j?T*(fp+S):0)-1):"rightTop"===W?(Mq=(V.x+V.width)*w+S+("h"===j?T*(fp+S):0)+1,wg=V.y*w-fp-S-("v"===j?T*(fp+S):0)-1):"leftBottom"===W?(Mq=V.x*w-fp-S-("h"===j?T*(fp+S):0)-1,wg=(V.y+V.height)*w+S+("v"===j?T*(fp+S):0)+1):"rightBottom"===W&&(Mq=(V.x+V.width)*w+S+("h"===j?T*(fp+S):0)+1,wg=(V.y+V.height)*w+S+("v"===j?T*(fp+S):0)+1);var G=Mq+Xn,N=wg+Xn,O=(V.x+V.width/2)*w,$=(V.y+V.height/2)*w,J=Yo({x:O,y:$},G-O,N-$,n);if("host"===p){if(z>0)return P.$77l(X,n,J),!0}else if("edge"===p){if(u>0)return P.$80l(X,n,J),!0}else if("remove"===p){if(l>0)return Hn&&1===Hn.length&&Hn[0]instanceof c?P.$81l(X,n,{x:O+fp/2+5,y:$}):P.$81l(X,n,J),!0}else if("parent"===p){if(Y>0)return Hn&&1===Hn.length&&Hn[0]instanceof c?P.$76l(X,n,{x:O-fp/2-5,y:$}):P.$76l(X,n,J),!0}else if("elevation"===p){if(Oo>0)return P.$85l(X,n,J),!0}else if("tall"===p){if(Fo>0)return P.$86l(X,n,J),!0}else if("source"===p||"target"===p){var m=Hn[0],q=y.getDataUI(m),v=ah(q,!0),a=v[0],C=v[1];if(vk&&"source"===p)return P.$84l(X,V,a,!0,m.isLooped(),W,T,j),!0;if(hq&&"target"===p)return P.$84l(X,V,C,!1,m.isLooped(),W,T,j),!0}};if(mq&&mq.length>0){var lp=0;mq.forEach(function(b){Co(b,"leftTop",lp,y.getLeftTopHelpersAlign()||"h")&&lp++})}if(gr&&gr.length>0){var lp=0;gr.forEach(function(d){Co(d,"rightTop",lp,y.getRightTopHelpersAlign()||"h")&&lp++})}if(yj&&yj.length>0){var lp=0;yj.forEach(function(q){Co(q,"leftBottom",lp,y.getLeftBottomHelpersAlign()||"h")&&lp++})}if(zq&&zq.length>0){var lp=0;zq.forEach(function(w){Co(w,"rightBottom",lp,y.getRightBottomHelpersAlign()||"h")&&lp++})}if(Ph&&Ph.length>0&&((vk||hq)&&Hn&&1===Hn.length&&Hn[0]instanceof c?!0:!1)){var lp=0;Ph.forEach(function(R){Co(R,"edge",lp,"h")&&lp++})}if(P.$72l){var me,pr=P.$67l,Rl=P.$68l,sq=P.$69l,Uc=(P.$71l,P.$70l),pi=P.$82l,Dc=P.$83l;if(1===pr?me=Rl:2===pr?me=sq:3===pr?me=Uc:5===pr?me=pi:6===pr&&(me=Dc),me){var Wj=y.lp(P.$72l),Qg=y.getDataAt(P.$72l);if(Qg&&Qg instanceof D){var Gh,Yb,ql;if(P.$73l=Qg,1===pr)if(Qg instanceof r.Grid)Gh=P.$75l=jd(Qg,Wj);else if(Qg instanceof r.Shape){ql=P.$74l=on(Qg,Wj);var kd=Qg.getPoints();if(ql){var Db=ql.attachIndex,Nr=ce(Qg,y.getDataUI(Qg),Db)+1,xg=Nr+1>=kd.size()?0:Nr+1,Um=kd.get(Nr),Eo=kd.get(xg),wr=Qg.p(),dk=Qg.getRotation();Um=Yo(wr,Um.x-wr.x,Um.y-wr.y,dk),Eo=Yo(wr,Eo.x-wr.x,Eo.y-wr.y,dk),X.beginPath(),X.strokeStyle=e,X.lineWidth=W,X.moveTo(Um.x*w,Um.y*w),X.lineTo(Eo.x*w,Eo.y*w),X.stroke()}}Gh?Yb=Gh.rect:(Yb=E.clone(y.getDataUIBounds(Qg)),E.grow(Yb,2)),X.beginPath(),X.rect(Yb.x*w,Yb.y*w,Yb.width*w,Yb.height*w),X.strokeStyle=1===pr||4===pr||6===pr?_:M,X.lineWidth=2,X.setLineDash&&X.setLineDash([8,8]),X.stroke()}else delete P.$73l;Wj.x=Wj.x*w,Wj.y=Wj.y*w;var $r=Zn(me.x,me.y,Wj.x,Wj.y),Br=Yo(me,Wj.x-me.x,Wj.y-me.y,-$r),Ur=Br.x-me.x;X.save(),X.translate(me.x,me.y),X.rotate($r),s.width=Ur,s.height=40;var kf=M;(1===pr||4===pr||6===pr)&&(kf=_),s.comps[0].gradientColor=kf,E.drawImage(X,s,0,-20,Ur,40),X.restore()}}}if(o.each(function(u){var K=y.getDataUI(u);if(K){var I,l,F=K._55O,k=K._78o;if(F&&F._43O&&u instanceof A?(I=F.$15l,l=u.getSegments(),l&&l.size()||(l=Xp(I)),u.isClosePath()&&l.indexOf(5)<0&&(l=new a(l._as),l.add(5))):F&&k&&F._43O&&(I=u.s("edge.points"),l=u.s("edge.segments"),I=Aq(K,I),l&&l.size()||(l=Xp(I)),I&&(I=I._as)),I&&l){var R=0,r=l.size(),g=P._hoverSegmentIndex;I=I.slice(0);for(var s=0;s<I.length;s++)I[s]=Hp(I[s],w);X.beginPath(),X.strokeStyle=v,X.lineWidth=1,R=0;for(var s=0;r>s;s++){var q=l.get(s);if(1===q||2===q)R++;else if(3===q){var G=I[R-1],M=I[R],J=I[R+1];X.moveTo(G.x,G.y),X.lineTo(M.x,M.y),X.lineTo(J.x,J.y),R+=2}else if(4===q){var G=I[R-1],i=I[R],m=I[R+1],J=I[R+2];X.moveTo(G.x,G.y),X.lineTo(i.x,i.y),X.moveTo(m.x,m.y),X.lineTo(J.x,J.y),R+=3}}if(X.stroke(),f===u||B===u&&"points"===B.s("edge.type")){X.beginPath(),R=0,X.strokeStyle=e,X.lineWidth=W;for(var s=0;r>s;s++){var q=l.get(s);if(1===q||2===q){if(g===s){var G=I[R-1],J=I[R];X.moveTo(G.x,G.y),X.lineTo(J.x,J.y);break}R++}else if(3===q){if(g===s){var G=I[R-1],M=I[R],J=I[R+1];X.moveTo(G.x,G.y),X.quadraticCurveTo(M.x,M.y,J.x,J.y);break}R+=2}else if(4===q){if(g===s){var G=I[R-1],i=I[R],m=I[R+1],J=I[R+2];X.moveTo(G.x,G.y),X.bezierCurveTo(i.x,i.y,m.x,m.y,J.x,J.y);break}R+=3}else if(5===q&&g===s){var G=I[R-1],J=I[0];X.moveTo(G.x,G.y),X.lineTo(J.x,J.y);break}}X.stroke()}X.beginPath(),R=0,X.strokeStyle=p,X.lineWidth=1,X.fillStyle=L;for(var s=0;r>s;s++){var q=l.get(s);if(1===q||2===q){var J=I[R];X.moveTo(J.x+S,J.y),X.arc(J.x,J.y,S,0,N,!0),R++}else if(3===q){var J=I[R+1];X.moveTo(J.x+S,J.y),X.arc(J.x,J.y,S,0,N,!0),R+=2}else if(4===q){var J=I[R+2];X.moveTo(J.x+S,J.y),X.arc(J.x,J.y,S,0,N,!0),R+=3}}X.fill(),X.stroke(),X.beginPath(),R=0,X.strokeStyle=Z,X.lineWidth=1,X.fillStyle=Q;for(var s=0;r>s;s++){var q=l.get(s);if(1===q||2===q)R++;else if(3===q){var M=I[R];X.moveTo(M.x+S,M.y),X.arc(M.x,M.y,S,0,N,!0),R+=2}else if(4===q){var i=I[R],m=I[R+1];X.moveTo(i.x+S,i.y),X.arc(i.x,i.y,S,0,N,!0),X.moveTo(m.x+S,m.y),X.arc(m.x,m.y,S,0,N,!0),R+=3}}if(X.fill(),X.stroke(),X.beginPath(),R=0,X.strokeStyle=x,X.lineWidth=2,(f===u||B===u)&&P.$9l!=H){var J=I[P.$9l];X.moveTo(J.x+S,J.y),X.arc(J.x,J.y,S,0,N,!0),X.stroke()}}}}),P.$87l&&y.sm().contains(P.$87l)){var Ij,bm=P.$87l,cb=P.$88l,fp=y.getEditHelperSize(),Xn=fp/2;if(y.isHelperEditable(bm,"pointElevation"))if(bm instanceof A){var $l=bm.getPosition();Ij=E.clone(bm.getPoints().get(cb)),Ij=Yo({x:$l.x,y:$l.y},Ij.x-$l.x,Ij.y-$l.y,bm.getRotation()),Ij.x*=w,Ij.y*=w,X.translate(Ij.x,Ij.y),E.drawImage(X,E.getImage("xeditinteractor_elevationIcon"),Xn,-Xn,fp,fp),X.translate(-Ij.x,-Ij.y),P._pointElevationHelperPoint={x:Ij.x+fp,y:Ij.y}}else if(bm instanceof c){var vl=Aq(y.getDataUI(bm),bm.s("edge.points")),Ij=E.clone(vl.get(cb));Ij.x*=w,Ij.y*=w,X.translate(Ij.x,Ij.y),E.drawImage(X,E.getImage("xeditinteractor_elevationIcon"),Xn,-Xn,fp,fp),X.translate(-Ij.x,-Ij.y),P._pointElevationHelperPoint={x:Ij.x+fp,y:Ij.y}}}X.restore(),P.$5l=0}},$89l:function(l,A,W,O){l.save();var i=this,v=i.gv,Q=v.getEditHelperSize(),Y=Q/2;l.beginPath(),l.translate(W.x,W.y),l.rotate(A),E.drawImage(l,O,-Y,-Y,Q,Q),l.restore()},$85l:function($,v,Q){var f=this;f.$90l=Q,f.$89l($,v,Q,E.getImage("xeditinteractor_elevationIcon"))},$86l:function(z,g,w){var r=this;r.$91l=w,r.$89l(z,g,w,E.getImage("xeditinteractor_tallIcon"))},$77l:function(c,J,H){var M=this;M.$68l=H,M.$89l(c,J,H,E.getImage("xeditinteractor_hostIcon"))},$80l:function(U,D,Q){var i=this;i.$70l=Q,i.$89l(U,D,Q,E.getImage("xeditinteractor_edgeIcon"))},$81l:function(i,c,o){var V=this;V.$71l=o,V.$89l(i,c,o,E.getImage("xeditinteractor_removeIcon"))},$76l:function(U,J,k){var S=this;S.$69l=k,S.$89l(U,J,k,E.getImage("xeditinteractor_parentIcon"))},$84l:function(A,G,U,i,b){var x,l=this,u=l.gv,Q=u.getZoom(),Y=u.getEditHelperSize(),Z=Y/2;U.x*=Q,U.y*=Q,b&&(i?U.x-=Z+5:U.x+=Z+5),U.y-=Y-2,i?(l.$82l=U,x=E.getImage("xeditinteractor_sourceIcon")):(l.$83l=U,x=E.getImage("xeditinteractor_targetIcon")),A.beginPath(),A.translate(U.x,U.y),E.drawImage(A,x,-Z,-Z,Y,Y),A.translate(-U.x,-U.y)},$44l:function(B,q,N){B.save();var x=this.gv.getZoom(),O=T(f(q.width,2)+f(q.height,2))/2*x+10,W=O,v=W+8,D=W+18,i=N,o=q.x+q.width/2,z=q.y+q.height/2;B.translate(o*x,z*x),B.beginPath(),B.strokeStyle="rgb(150, 150, 150)";for(var $=0,M=0,R=0,X=0,Q=0,p=0;360>p;p++)$=p*l/180,0===p%5&&(M=L($)*W,R=Y($)*W,X=L($)*v,Q=Y($)*v,B.moveTo(M,R),B.lineTo(X,Q)),0===p%45&&(M=L($)*W,R=Y($)*W,X=L($)*D,Q=Y($)*D,B.moveTo(M,R),B.lineTo(X,Q));B.stroke(),B.beginPath(),B.rotate(-g),B.beginPath(),B.fillStyle="rgba(255, 0, 0, 0.1)",B.strokeStyle="rgb(157, 157, 157)",B.moveTo(0,0),B.arc(0,0,D,0,N,!1),B.fill(),B.beginPath(),B.moveTo(0+D,0),B.arc(0,0,D,0,N,!1),B.stroke(),B.rotate(g),B.font="bold 12px Verdana, Arial";var S=20*Y(i),u=20*L(i),t=w(180*i/l)+"";B.textAlign="center",B.textBaseline="middle",B.beginPath();var b=B.measureText("365.").width;B.fillStyle="white",B.rect(S-b/2,-u-10,b,20),B.fill(),B.beginPath(),B.fillStyle="rgb(79,79,79)",B.fillText(t,S,-u),B.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);